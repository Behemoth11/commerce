(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[863],{3503:function(e,t,n){"use strict";var r=n(2058),i=n.n(r),o=n(7294),a=n(5893),u=function(e){var t=e.errMsg;return(0,a.jsx)(a.Fragment,{children:t.length>0&&(0,a.jsx)("ul",{className:i().errorContainer,children:t.map((function(e){return(0,a.jsxs)("li",{children:["* ",e,"."]},e)}))})})};t.Z=(0,o.memo)(u)},8460:function(e,t,n){"use strict";var r=n(2809),i=n(6563),o=n.n(i),a=n(7294),u=n(5893);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){var t,n=e.name,i=e.required,c=e.inputValue,l=e.submitCount,p=e.setInputValue;(0,a.useEffect)((function(){p((function(e){return s(s({},e),{},(0,r.Z)({},n,""))}))}),[]);return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)("div",{className:"".concat(o().inputContainer," ").concat(o().textArea," "),children:[(0,u.jsx)("textarea",{value:c[n]||"",name:c[n],id:n,onChange:function(e){return t=e.target.value,void p((function(e){return s(s({},e),{},(0,r.Z)({},n,t))}));var t},className:"flex-center ".concat(o().filled," ").concat(i&&l>0&&!(null!==(t=c[n])&&void 0!==t&&t.length)&&o().failure)}),(0,u.jsx)("label",{htmlFor:n,children:n})]})})};t.Z=(0,a.memo)(l)},1208:function(e,t,n){"use strict";var r=n(4262),i=n.n(r),o=n(9920),a=n(2770),u=n(7294),c=n(5893);t.Z=function(e){var t=e.children,n=e.state,r=e.setState,s=e.no_scroll,l=e.customMessage,p=e.pseudoStateDuration,d=(0,o.useSpring)({x:"success"==n||"failure"==n?"0%":"-100%",from:{x:"-100%"}}),f=(0,o.useTransition)("loading"==n,{enter:{opacity:"1",transform:"scale(1)"},leave:{opacity:"1",transform:"scale(1)"},from:{opacity:"1",transform:"scale(0.9)"}}),m=(0,u.useRef)(n);return(0,u.useEffect)((function(){["loading","success","failure"].includes(n)||(m.current=n)}),[n]),(0,u.useEffect)((function(){"success"!=n&&"failure"!=n||setTimeout((function(){r(m.current)}),p||1e3)}),[n]),(0,u.useEffect)((function(){var e=document.getElementById("__next");e.scroll(0,0),"loading"==n&&s?e.style.overflow="hidden":"success"!=n&&"failure"!=n&&s&&(e.style.overflow="")}),[n]),(0,c.jsxs)("div",{className:"".concat(i().controller),children:[f((function(e,t){return t&&(0,c.jsx)(o.animated.div,{className:"".concat(i().states),style:e,children:(0,c.jsx)("div",{children:(0,c.jsx)(a.Z,{width:"80px",background:"var(--accent-color-1)"})})})})),(0,c.jsx)(o.animated.div,{className:"".concat(i().states),style:d,children:(0,c.jsx)("div",{children:(0,c.jsx)("p",{className:"".concat(i()[n]," ").concat(i().message),children:l&&l[n]})})}),(0,c.jsx)("div",{children:t})]})}},3513:function(e,t,n){"use strict";var r=n(1289),i=n.n(r),o=n(7294),a=n(9389),u=n(5893),c=function(e){var t=e.ASPECT_RATIO,n=e.imageLink,r=e.isVisible,c=e.onLoad,s=e.observer,l=e.loadingState,p=e.no_optimization,d=(0,o.useRef)(),f=(0,o.useState)(void 0),m=f[0],v=f[1],g=(0,o.useState)(!0),h=g[0],b=g[1],j=(0,a.$9)();(0,o.useEffect)((function(){var e,r;p||n&&v((e=n,r=d.current.clientWidth,"https://res.cloudinary.com/dkoatnxem/image/upload/ar_".concat(100/t,",c_crop/c_scale,w_").concat(r+100,"/").concat(e)))}),[j.size,n,t]),(0,o.useEffect)((function(){s&&s.observe(d.current)}),[s]),(0,o.useEffect)((function(){r&&s&&s.unobserve(d.current)}),[r]);var x=c||function(e){return 2};return(0,u.jsx)("div",{children:(0,u.jsx)("div",{className:i().myImage,ref:d,style:{paddingTop:"".concat(t,"%")},children:r&&((p&&n||m)&&(0,u.jsx)("img",{src:p&&n||m,alt:"There will soon be an alt",style:{opacity:1},onLoad:function(e){x(e),b(!1)}})||l&&h&&(0,u.jsx)("div",{className:i().loadingPlaceholder,children:"...Loading"}))})})};t.Z=(0,o.memo)(c)},2608:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return U},useUploadContext:function(){return F}});var r=n(2809),i=n(266),o=n(809),a=n.n(o),u=n(7756),c=n(7294),s=n(9669),l=n.n(s),p=n(1163),d=n(3503),f=n(7734),m=n.n(f),v=n(3789),g=n(6563),h=n.n(g),b=n(5893);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e){var t,n,i,o=e.type,a=e.name,u=e.required,s=e.inputValue,l=e.submitCount,p=e.proposition,d=e.setInputValue,f=(0,c.useState)(""),m=f[0],g=f[1],j=(0,c.useRef)();(0,c.useEffect)((function(){d((function(e){return x(x({},e),{},(0,r.Z)({},a,[]))}))}),[]);var _=function(e,t){e.preventDefault(),j.current.focus(),t.length<=0||(g(""),d((function(e){return new RegExp(t,"i").test(e[a])?e:x(x({},e),{},(0,r.Z)({},a,[].concat((0,v.Z)(e[a]),[t])))})))},y=p&&(null===(t=p[a])||void 0===t?void 0:t.filter((function(e){var t;return new RegExp(m,"i").test(e)&&!(null!==(t=s[a])&&void 0!==t&&t.includes(e))})));return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"".concat(h().inputContainer),children:[(0,b.jsx)("input",{value:m,name:s[a],id:a,onChange:function(e){return g(e.target.value.toLowerCase())},className:"flex-center ".concat((null===m||void 0===m?void 0:m.length)&&h().filled," ").concat(u&&l>0&&!(null!==(n=s[a])&&void 0!==n&&n.length)&&h().failure),ref:j,type:o||"text",autoComplete:"off"}),(0,b.jsx)("label",{htmlFor:a,children:a}),(null===y||void 0===y?void 0:y.length)>0||!p&&(0,b.jsx)("button",{className:h().addButtonArray,onClick:function(e){return _(e,m)},children:"add"})||(0,b.jsx)("button",{className:h().createProposition,onClick:function(e){return _(e,m)},children:"create"}),(null===y||void 0===y?void 0:y.length)>0&&(0,b.jsx)("div",{className:h().proposition,children:y.map((function(e){return(0,b.jsx)("p",{onClick:function(t){return _(t,e)},children:e},e)}))})]}),(0,b.jsx)("div",{className:h().inputArrayChoices,children:null===(i=s[a])||void 0===i?void 0:i.map((function(e,t){return(0,b.jsx)("p",{onClick:function(){return function(e){var t;null===j||void 0===j||null===(t=j.current)||void 0===t||t.focus(),d((function(t){return x(x({},t),{},(0,r.Z)({},a,[].concat((0,v.Z)(t[a].slice(0,e)),(0,v.Z)(t[a].slice(e+1)))))}))}(t)},children:e},t)}))})]})},y=(0,c.memo)(_),O=n(8977),w=n(8460),C=n(5035),P=n(3513);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E=function(e){var t,n=e.name,i=e.position,o=e.imageLink,a=e.submitCount,u=e.setInputValue,c=new RegExp("data:image").test(null===o||void 0===o?void 0:o.slice(0,14)),s=c&&o||(null===o||void 0===o?void 0:o.split("upload/")[1]);return(0,b.jsx)("div",{className:"".concat(h().inputImageContainer),children:(0,b.jsxs)("div",{style:{width:"100%",position:"relative",paddingTop:"2px"},children:[(0,b.jsx)(P.Z,{isVisible:!0,ASPECT_RATIO:100,imageLink:s,no_optimization:c,onLoad:function(e){if(c){var t=document.createElement("canvas"),o=500/e.target.width;t.width=500,t.height=e.target.height*o;var a=t.getContext("2d");a.drawImage(e.target,0,0,t.width,t.height);var s=a.canvas.toDataURL(e.target,"image/jpeg");u((function(e){var t=e[n]||[""];return s.length<t[i].length&&(t[i]=s),S(S({},e),{},(0,r.Z)({},n,t))}))}}}),(0,b.jsx)("input",{type:"file",name:n,id:n+i+"0",className:"".concat(a>0&&!(o&&null!==(t=o[0])&&void 0!==t&&t.length)&&h().failure),onChange:function(e){return function(e,t,n){var i=new FileReader;i.onload=function(){2==i.readyState&&u((function(e){var o=e[t]||[""];return o[n]=i.result,S(S({},e),{},(0,r.Z)({},t,o))}))},i.readAsDataURL(e.target.files[0])}(e,n,i)},required:!0,accept:"image/*"}),null===s||void 0===s?void 0:s.length,(0,b.jsx)("label",{htmlFor:n+i+"0",children:n})]})})},N=(0,c.memo)(E),Z=n(1208);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D=function(e){var t,n=e.name,i=e.inputValue,o=e.submitCount,a=e.setInputValue,u=i[n]||["",""];return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:h().imagesInput,children:u.map((function(e,t){return(0,b.jsxs)("div",{style:{width:"49.5%",position:"relative"},children:[(0,b.jsx)(N,{name:n,position:t,imageLink:e,submitCount:o,setInputValue:a}),(0,b.jsx)("button",{className:h().rm,onClick:function(e){return function(e,t,n){e.preventDefault(),a((function(e){var i=e[t];return!i||i.length<=0?e:V(V({},e),{},(0,r.Z)({},t,[].concat((0,v.Z)(i.slice(0,n)),(0,v.Z)(i.slice(n+1)))))}))}(e,n,t)}})]},t)}))}),(0,b.jsxs)("div",{className:h().superInput,children:[(0,b.jsx)("input",{type:"file",name:n,id:"".concat(n,"-multiple-input"),accept:"image/*",multiple:!0,onChange:function(e){return function(e){for(var t=!1,i=function(i){var o=new FileReader;o.onload=function(){2==o.readyState&&a((function(e){var i=e[n]||[];return t||(i=i.filter((function(e){return e.length>0})),t=!0),i.push(o.result),V(V({},e),{},(0,r.Z)({},n,i))}))},o.readAsDataURL(e.target.files[i])},o=0;o<e.target.files.length;o++)i(o)}(e)},required:!0}),(0,b.jsxs)("label",{htmlFor:"".concat(n,"-multiple-input"),children:["Add Multiple (",null===(t=i[n])||void 0===t?void 0:t.length,")"]})]})]})},R=(0,c.memo)(D),A=n(9389);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=(0,c.createContext)({submitCount:0,proposition:{},editState:"upload",setInputValue:void 0}),F=function(){return(0,c.useContext)(L)},B={tags:!0,color:!0,related:!0,materials:!0,representation:!0};var U=function(){var e=(0,p.useRouter)().query,t=(0,A.BU)(),n=(0,c.useState)("upload"),r=n[0],o=n[1],s=(0,c.useRef)("upload"),f=function(e){o(e),"update"!=e&&"upload"!=e||(s.current=e)};(0,c.useEffect)((function(){e._id&&f("update")}),[e._id]),(0,c.useEffect)((function(){var e;null===(e=document.getElementById("__next"))||void 0===e||e.scroll(0,0)}),[s.current]),(0,c.useEffect)((function(){var t=function(){var t=(0,i.Z)(a().mark((function t(n){var r,i,o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l().get("/api/product/withId/".concat(e._id)).catch((function(e){return console.log(e)}));case 2:(r=t.sent)&&(i=null===r||void 0===r||null===(o=r.data)||void 0===o?void 0:o.products[0]),i&&_(q(q({},i),{},{presentationImage:(0,C.CN)(i.pr_image_url),images:(0,C.CN)(i.all_pr_image_url)}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();"update"==s.current&&t(e._id)}),[s.current]);var v=(0,c.useState)(0),g=v[0],h=v[1],j=(0,c.useState)({}),x=j[0],_=j[1],P=(0,c.useState)([]),I=P[0],S=P[1],E=(0,c.useState)({color:["blue","green","purple","brown","black","white"],materials:["inexpensive","affordable","good","bad"],categories:(0,u.CP)(u.Mk,["menu"]),tags:["inexpensive","affordable","good","bad"],representation:["hot deals","women","men","stuff"],nature:["book"]}),k=E[0],V=(E[1],function(){var n=(0,i.Z)(a().mark((function n(r){var i,u;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r.preventDefault(),h((function(e){return e+1})),document.getElementById("__next").scroll(0,0),i=[],(0,C.uE)(x,B,i),S([].concat(i)),!(i.length>0)){n.next=9;break}return f(s.current),n.abrupt("return");case 9:if(o("loading"),"update"!=s.current){n.next=16;break}return n.next=13,t.axios.put("/api/product/withId/".concat(e._id),x).catch((function(e){return u=e.response}));case 13:u=n.sent,n.next=20;break;case 16:if("upload"!=s.current){n.next=20;break}return n.next=19,t.axios.post("/api/product",x).catch((function(e){return u=e.response}));case 19:u=n.sent;case 20:u?200===u.status?(f("success"),h(0),S([]),_((function(e){return q(q({},e),{},{productName:""})})),setTimeout((function(){f("upload")}),1e3)):(f("failure"),S([u.data.message||u.data])):f("failure");case 21:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());return(0,b.jsx)("form",{children:(0,b.jsx)(L.Provider,{value:{submitCount:g,setInputValue:_,proposition:k,editState:s.current},children:(0,b.jsx)(Z.Z,{customMessage:{success:"Operation successfully, completed",failure:"Something went wrong"},no_scroll:!0,state:r,setState:f,children:(0,b.jsxs)("div",{className:"".concat(m().boss),children:[(0,b.jsx)("div",{className:m().editState,children:["upload","update"].map((function(e){return(0,b.jsx)("p",{className:"".concat(s.current==e&&m().active),onClick:function(){return f(e)},children:e},e)}))}),(0,b.jsx)(d.Z,{errMsg:I}),(0,b.jsx)(O.Z,{required:!0,name:"productName",inputValue:x,submitCount:g,proposition:k,setInputValue:_}),(0,b.jsx)(N,{name:"presentationImage",position:0,imageLink:x.presentationImage&&x.presentationImage[0],submitCount:g,setInputValue:_}),"categories".split("/").map((function(e){return(0,b.jsx)(y,{name:e,required:!0,inputValue:x,submitCount:g,proposition:k,setInputValue:_},e)})),"color/materials/tags".split("/").map((function(e){return(0,b.jsx)(y,{name:e,required:!1,inputValue:x,submitCount:g,proposition:k,setInputValue:_},e)})),(0,b.jsx)(O.Z,{name:"price",required:!0,type:"number",inputValue:x,submitCount:g,proposition:k,setInputValue:_}),(0,b.jsx)(O.Z,{name:"location",required:!1,inputValue:x,submitCount:g,proposition:k,setInputValue:_}),(0,b.jsx)(O.Z,{required:!1,name:"representation",inputValue:x,submitCount:g,proposition:k,setInputValue:_}),(0,b.jsx)(w.Z,{required:!0,name:"description",inputValue:x,submitCount:g,setInputValue:_}),(0,b.jsx)(R,{name:"images",inputValue:x,submitCount:g,setInputValue:_}),(0,b.jsx)("div",{className:"container flex center-children",children:(0,b.jsx)("button",{onClick:V,className:m().submit,children:(0,b.jsx)("span",{children:"Submit"})})})]})})})})}},1441:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/upload",function(){return n(2608)}])},2058:function(e){e.exports={errorContainer:"style_errorContainer__1Sz_Y"}},1289:function(e){e.exports={myImage:"style_myImage__NFAoT",loadingPlaceholder:"style_loadingPlaceholder__1xRcB"}},7734:function(e){e.exports={boss:"upload_boss__17r31",proposition:"upload_proposition__gZo3R",addButtonArray:"upload_addButtonArray__1IQse",createProposition:"upload_createProposition__aURYW",superInput:"upload_superInput__1xH7s",inputContainer:"upload_inputContainer__1Nl1u",failure:"upload_failure__16Qe7",inputArrayChoices:"upload_inputArrayChoices__254Hx",editState:"upload_editState__iijS_",active:"upload_active__30Vo8",filled:"upload_filled__18xtj",inputImageContainer:"upload_inputImageContainer__27GHD",add:"upload_add__kfj3d",rm:"upload_rm__D3Tkm",submit:"upload_submit__y9GVW",imagesInput:"upload_imagesInput__ncA7_",utilState:"upload_utilState__1PqUc"}}},function(e){e.O(0,[774,888,179],(function(){return t=1441,e(e.s=t);var t}));var t=e.O();_N_E=t}]);